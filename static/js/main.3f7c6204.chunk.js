(this["webpackJsonptwitter-clone"]=this["webpackJsonptwitter-clone"]||[]).push([[0],{64:function(e,t,c){},66:function(e,t,c){"use strict";c.r(t);var n=c(0),a=c.n(n),s=c(22),r=c.n(s),o=c(19),i=c(9),l=c(7),j=c(68),d=c(69),u=c(45),b=c(75),O=c(15),h=c(17),x=c(23),f=c(73),m=c(74),v=c(70),p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",c=arguments.length>2?arguments[2]:void 0;return new Promise((function(n,a){var s=localStorage.getItem("token");s?fetch("https://secret-temple-42258.herokuapp.com/".concat(e,"/"),{method:t,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify(c)}).then((function(e){return e.json()})).then((function(e){return n(e)})).catch((function(e){return a(e)})):a("non c'\xe8 il token")}))},g=c(1),w=function(e){var t=Object(n.useState)(""),c=Object(l.a)(t,2),a=c[0],s=c[1],r=Object(n.useState)(""),o=Object(l.a)(r,2),i=o[0],b=o[1],O=Object(n.useState)(""),h=Object(l.a)(O,2),w=h[0],k=h[1],y=Object(n.useState)(!1),C=Object(l.a)(y,2),S=C[0],N=C[1];Object(n.useEffect)((function(){T()}),[]);var T=function(){p("users/profile","GET").then((function(e){s(e.name),b(e.bio),k(e.avatar);var t=localStorage.getItem("distractionMode");console.log(t),N(""!==t&&t)}))};return Object(g.jsx)("div",{children:Object(g.jsxs)(f.a,Object(x.a)(Object(x.a)({},e),{},{"aria-labelledby":"contained-modal-title-vcenter",children:[Object(g.jsx)(f.a.Header,{closeButton:!0,children:Object(g.jsx)(f.a.Title,{id:"contained-modal-title-vcenter",children:"Modifica le tue info"})}),Object(g.jsx)(f.a.Body,{className:"show-grid",children:Object(g.jsx)(j.a,{children:Object(g.jsx)(d.a,{children:Object(g.jsx)(u.a,{xs:12,md:8,children:Object(g.jsxs)(m.a,{onSubmit:function(e){e.preventDefault(),p("users/profile","PUT",{name:a,bio:i,avatar:w}).then((function(e){})),console.log(S),localStorage.setItem("distractionMode",!0)},children:[Object(g.jsxs)(m.a.Group,{controlId:"formBasicName",children:[Object(g.jsx)(m.a.Label,{children:"Enter your name"}),Object(g.jsx)(m.a.Control,{type:"text",placeholder:"Enter your name",onChange:function(e){return s(e.target.value)},value:a})]}),Object(g.jsxs)(m.a.Group,{controlId:"formBasicBio",children:[Object(g.jsx)(m.a.Label,{children:"Write something about you"}),Object(g.jsx)(m.a.Control,{type:"text",placeholder:"Write something about you",onChange:function(e){return b(e.target.value)},value:i})]}),Object(g.jsxs)(m.a.Group,{controlId:"formBasicAvatar",children:[Object(g.jsx)(m.a.Label,{children:"Change your avatar"}),Object(g.jsx)(m.a.Control,{type:"text",placeholder:"Change your avatar",onChange:function(e){return k(e.target.value)},value:w})]}),Object(g.jsxs)(m.a.Group,{controlId:"formBasicFlag",children:[Object(g.jsx)(m.a.Label,{children:"Modalit\xe0 distraction free"}),Object(g.jsx)(m.a.Check,{onChange:function(e){return N(e.target.checked)},checked:S,type:"checkbox"})]}),Object(g.jsx)(v.a,{variant:"primary",type:"submit",children:"Submit"})]})})})})})]}))})};function k(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),c=t[0],a=t[1];return Object(g.jsxs)("div",{children:[Object(g.jsxs)(b.a,{defaultActiveKey:"/home",className:"flex-column navbar",children:[Object(g.jsxs)(b.a.Link,{href:"/home",className:"font-weight-bold",eventKey:"link-1",children:[Object(g.jsx)(h.a,{icon:O.e}),Object(g.jsx)("p",{className:"d-none d-sm-none d-md-block",children:"Home"})]}),Object(g.jsxs)(b.a.Link,{className:"font-weight-bold",eventKey:"link-2",children:[Object(g.jsx)(h.a,{icon:O.g}),Object(g.jsx)("p",{className:"d-none d-sm-none d-md-block",children:"Esplora"})]}),Object(g.jsxs)(b.a.Link,{className:"font-weight-bold",eventKey:"link-2",children:[Object(g.jsx)(h.a,{icon:O.a}),Object(g.jsx)("p",{className:"d-none d-sm-none d-md-block",children:"Notifiche"})]}),Object(g.jsxs)(b.a.Link,{className:"font-weight-bold",eventKey:"link-2",onClick:function(e){e.preventDefault(),a(!0)},children:[Object(g.jsx)(h.a,{icon:O.b}),Object(g.jsx)("p",{className:"d-none d-sm-none d-md-block",children:"Impostazioni"})]})]}),Object(g.jsx)(w,{show:c,onHide:function(){return a(!1)}})]})}var y=c(76),C=c(26),S=c.n(C),N=c(40);function T(e){var t=e.tweetsitem,c=(e.key,t._id),a=t.text,s=t.created,r=(t.updated,t.tags,t.creator),o=localStorage.getItem("userId"),i=Object(n.useState)(0),j=Object(l.a)(i,2),d=j[0],u=j[1],b=Object(n.useState)([]),x=Object(l.a)(b,2),f=x[0],m=x[1],w=Object(n.useState)(null),k=Object(l.a)(w,2),C=k[0],T=k[1];Object(n.useEffect)((function(){u(t.like),m(t.liked)}),[t]);var I=f.find((function(e){return e.id===o})),B=function(){I?(P(),T(!1)):(E(),T(!0))},E=function(){p("tweets/like/".concat(c),"POST").then((function(e){u(e.like),m(e.liked),T(null)}))},P=function(){p("tweets/unlike/".concat(c),"POST").then((function(e){u(e.like),m(e.liked),T(null)}))};return Object(g.jsx)("div",{className:"mb-2 mt-2",children:Object(g.jsx)(y.a,{children:Object(g.jsxs)(y.a.Body,{children:[Object(g.jsx)("div",{className:"tweet-info",children:Object(g.jsxs)("p",{children:[Object(g.jsxs)("b",{children:[r.name," ",r.username]}),Object(g.jsxs)("span",{className:"text-muted",children:[" - ",S()(s).fromNow()]})]})}),Object(g.jsxs)("div",{className:"text-left mb-4 mt-2",children:[" ",a," "]}),Object(g.jsxs)("div",{className:"tweet-icon-container",children:[Object(g.jsxs)(v.a,{size:"sm",onClick:B,disabled:null!==C,children:[Object(g.jsx)(h.a,{size:"xs",icon:null!==C?C?O.d:N.a:I?O.d:N.a})," ",d]}),Object(g.jsx)(v.a,{size:"sm",onClick:B,children:Object(g.jsx)(h.a,{size:"xs",icon:O.c})}),Object(g.jsx)(v.a,{size:"sm",onClick:B,children:Object(g.jsx)(h.a,{size:"xs",icon:O.f})}),Object(g.jsx)(v.a,{size:"sm",onClick:B,children:Object(g.jsx)(h.a,{size:"xs",icon:O.h})})]})]})})})}function I(e){var t=e.fetchTweets,c=Object(n.useState)(""),a=Object(l.a)(c,2),s=a[0],r=a[1],o=Object(n.useRef)(null);return Object(g.jsx)("div",{children:Object(g.jsx)(y.a,{children:Object(g.jsxs)(m.a,{className:"form-tweet",onSubmit:function(e){if(e.preventDefault(),""===e.target.value||""===s)return alert("scrivi il cazzo di tweet");p("tweets","POST",{text:s}).then((function(e){t(),r(""),o.current.value=""}))},children:[Object(g.jsx)(m.a.Group,{className:"form-text",children:Object(g.jsx)(m.a.Control,{ref:o,type:"text",placeholder:"scrivi un tweet",required:"required",onChange:function(e){return r(e.target.value)}})}),Object(g.jsx)("div",{className:"form-footer-btn",children:Object(g.jsx)(v.a,{className:"btn-tweet",type:"submit",children:"tweet"})})]})})})}var B=Object(n.createContext)({}),E=function(){return Object(n.useContext)(B)},P=function(e){var t=e.children,c=Object(n.useState)(""),a=Object(l.a)(c,2),s=a[0],r=a[1];Object(n.useEffect)((function(){s&&o(s)}),[s]),Object(n.useEffect)((function(){i()}),[]);var o=function(e){localStorage.setItem("token","".concat(e))},i=function(){var e=localStorage.getItem("token");""!==e?r(e):console.log("token non trovato")};return Object(g.jsx)(B.Provider,{value:{token:s,setToken:r},children:t})};function L(e){var t=e.tweetList,c=e.fetchTweets,a=Object(n.useState)([]),s=Object(l.a)(a,2),r=s[0],o=s[1],i=E().token;Object(n.useEffect)((function(){j(t)}),[i,t]);var j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,c=e.sort((function(e,c){return new Date(e.created).getTime()<new Date(c.created).getTime()?t:-t}));o(c)};return Object(g.jsxs)("div",{children:[Object(g.jsx)(I,{listUpdate:function(){p("tweets/feed").then((function(e){return j(e)}))},fetchTweets:c}),r.map((function(e){return Object(g.jsx)(T,{tweetsitem:e},e.id)}))]})}var z=c(71),G=c(77),D=function(){var e=Object(n.useState)(""),t=Object(l.a)(e,2),c=t[0],a=t[1],s=Object(i.f)();return Object(g.jsx)("div",{className:"search-bar mt-4",children:Object(g.jsx)(m.a,{onSubmit:function(e){e.preventDefault(),c&&s.push("/search/".concat(c))},children:Object(g.jsxs)(z.a,{controlId:"formBasicEmail",children:[Object(g.jsx)(m.a.Control,{type:"text",placeholder:"cerca",onChange:function(e){return a(e.target.value)}}),Object(g.jsx)(z.a.Append,{children:Object(g.jsx)(v.a,{variant:"primary",children:Object(g.jsx)(h.a,{icon:O.g})})})]})})})},F=c(72);function H(e){var t=e.username,c=(e.followingCount,e.followersCount),a=e.id,s=e.avatar,r=(e.following,e.followers),i=e.fetchUser,j=Object(n.useState)(!1),b=Object(l.a)(j,2),O=b[0],h=b[1],x=localStorage.getItem("userId");Object(n.useEffect)((function(){var e=r.find((function(e){return e===x}));h(e)}),[a]);var f=function(){p("users/follow/".concat(a),"POST").then((function(e){h(!0),i()}))},m=function(){p("users/unfollow/".concat(a),"POST").then((function(e){h(!1),i()}))};return Object(g.jsxs)(d.a,{className:"d-flex flex-row justify-content-between mb-4 align-items-center",children:[Object(g.jsx)(u.a,{children:Object(g.jsxs)(d.a,{xs:12,sm:12,md:10,className:"d-flex flex-row text-left align-items-center",children:[Object(g.jsx)(u.a,{xs:2,md:3,children:Object(g.jsx)(F.a,{style:{width:30,height:30},className:"mr-4",src:s,roundedCircle:!0})}),Object(g.jsxs)(u.a,{xs:10,md:9,children:[Object(g.jsx)(o.b,{to:"/profile/".concat(a),children:Object(g.jsx)("p",{className:"nome-user mb-0",children:t.split("@")[0]})}),Object(g.jsxs)("p",{children:["followers: ",c]})]})]})}),Object(g.jsx)(u.a,{children:Object(g.jsx)(d.a,{md:12,children:Object(g.jsx)(u.a,{xs:12,md:12,sm:12,children:Object(g.jsx)(v.a,{className:"follow-button",size:"sm",variant:"outline-info",onClick:function(){O?m():f()},children:O?"unfollow":"Follow"})})})})]})}function M(){var e=Object(n.useState)([]),t=Object(l.a)(e,2),c=t[0],a=t[1],s=function(){p("users").then((function(e){return r(e)}))},r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,c=e.sort((function(e,c){return e.followersCount<c.followersCount?t:-t}));a(c)};return Object(n.useEffect)((function(){s()}),[]),console.log(c),Object(g.jsx)(y.a,{children:Object(g.jsxs)(y.a.Body,{children:[Object(g.jsx)(y.a.Title,{className:"mb-4",children:"Profili da seguire"}),c.map((function(e,t){return Object(g.jsx)(H,{user:e,username:e.username,following:e.following,followingCount:e.followingCount,followersCount:e.followersCount,id:e.id,avatar:"https://i.pravatar.cc/30?img=".concat(t+1),followers:e.followers,fetchUser:s},t)}))]})})}var q=c(47),A=c.n(q),J=function(e){var t=e.tweetList,c=Object(n.useState)([]),a=Object(l.a)(c,2),s=a[0],r=a[1];Object(n.useEffect)((function(){i(t)}),[t]);var i=function(e){var t=[];e.map((function(e){if(e.tags.length>0)for(var c=0;c<e.tags.length;c++)t.push(e.tags[c])}));var c=A.a.countBy(t),n=Object.keys(c).map((function(e){return{id:e,name:e,count:c[e]}}));r(n)};return Object(g.jsx)(y.a,{children:Object(g.jsxs)(y.a.Body,{children:[Object(g.jsx)(y.a.Title,{className:"mb-4",children:"Tendenze"}),Object(g.jsx)(G.a,{children:s.map((function(e){return Object(g.jsx)(G.a.Item,{children:Object(g.jsxs)(o.b,{to:"/search/".concat(e.name.split("#")[1]),children:[e.name," ",e.count]})},e.id)}))})]})})};function K(){var e=Object(n.useState)([]),t=Object(l.a)(e,2),c=t[0],a=t[1],s=Object(i.g)().q,r=function(){s?p("tweets/tag/".concat(s)).then((function(e){a(e)})):p("tweets/feed").then((function(e){a(e)}))};return Object(n.useEffect)((function(){r()}),[s]),Object(g.jsx)("div",{children:Object(g.jsx)(j.a,{children:Object(g.jsxs)(d.a,{children:[Object(g.jsx)(u.a,{md:2,sm:1,xs:2,children:Object(g.jsx)(k,{})}),Object(g.jsx)(u.a,{md:6,sm:8,xs:10,children:Object(g.jsx)(L,{tweetList:c,fetchTweets:r})}),Object(g.jsxs)(u.a,{md:4,className:"d-none d-md-block d-lg-block",children:[Object(g.jsx)("div",{className:"mb-4",children:Object(g.jsx)(D,{})}),Object(g.jsx)("div",{className:"mb-4",children:Object(g.jsx)(J,{tweetList:c})}),Object(g.jsx)("div",{children:Object(g.jsx)(M,{})})]})]})})})}function R(e){var t=Object(n.useState)(""),c=Object(l.a)(t,2),a=c[0],s=c[1],r=Object(n.useState)(""),o=Object(l.a)(r,2),b=o[0],O=o[1];Object(i.f)();return Object(g.jsx)("div",{children:Object(g.jsxs)(f.a,Object(x.a)(Object(x.a)({},e),{},{"aria-labelledby":"contained-modal-title-vcenter",children:[Object(g.jsx)(f.a.Header,{closeButton:!0,children:Object(g.jsx)(f.a.Title,{id:"contained-modal-title-vcenter",children:"Register here"})}),Object(g.jsx)(f.a.Body,{className:"show-grid",children:Object(g.jsx)(j.a,{children:Object(g.jsx)(d.a,{children:Object(g.jsx)(u.a,{xs:12,md:8,children:Object(g.jsxs)(m.a,{children:[Object(g.jsxs)(m.a.Group,{controlId:"formBasicEmail",children:[Object(g.jsx)(m.a.Label,{children:"Email address"}),Object(g.jsx)(m.a.Control,{type:"text",placeholder:"user name",value:a,onChange:function(e){return s(e.target.value)}}),Object(g.jsx)(m.a.Text,{className:"text-muted",children:"We'll never share your email with anyone else."})]}),Object(g.jsxs)(m.a.Group,{controlId:"formBasicPassword",children:[Object(g.jsx)(m.a.Label,{children:"Password"}),Object(g.jsx)(m.a.Control,{type:"password",placeholder:"Password",value:b,onChange:function(e){return O(e.target.value)}})]}),Object(g.jsx)(m.a.Group,{controlId:"formBasicCheckbox",children:Object(g.jsx)(m.a.Check,{type:"checkbox",label:"Check me out"})})]})})})})}),Object(g.jsxs)(f.a.Footer,{children:[Object(g.jsx)(v.a,{variant:"primary",type:"submit",onClick:function(){fetch("https://secret-temple-42258.herokuapp.com/auth/signup",{method:"POST",body:JSON.stringify({username:a,password:b}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){t.user.id?e.onHide():alert("non sei registrato")}))},children:"Register"}),Object(g.jsx)(v.a,{onClick:e.onHide,children:"Close"})]})]}))})}function U(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),c=t[0],a=t[1],s=Object(n.useState)(""),r=Object(l.a)(s,2),o=r[0],j=r[1],d=Object(n.useState)(""),u=Object(l.a)(d,2),b=u[0],O=u[1],h=Object(i.f)(),x=E(),f=(x.token,x.setToken);return Object(g.jsx)("div",{children:Object(g.jsxs)(m.a,{onSubmit:function(e){e.preventDefault(),fetch("https://secret-temple-42258.herokuapp.com/auth/login",{method:"POST",body:JSON.stringify({username:o,password:b}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){e.token?(f(e.token),localStorage.setItem("userId",e.user.id),h.push("/home")):alert("non sei registrato")}))},children:[Object(g.jsxs)(m.a.Group,{controlId:"formBasicEmail",children:[Object(g.jsx)(m.a.Label,{children:"Email address"}),Object(g.jsx)(m.a.Control,{type:"text",placeholder:"Enter email",onChange:function(e){return j(e.target.value)}}),Object(g.jsx)(m.a.Text,{className:"text-muted",children:"We'll never share your email with anyone else."})]}),Object(g.jsxs)(m.a.Group,{controlId:"formBasicPassword",children:[Object(g.jsx)(m.a.Label,{children:"Password"}),Object(g.jsx)(m.a.Control,{type:"password",placeholder:"Password",onChange:function(e){return O(e.target.value)}})]}),Object(g.jsx)(m.a.Group,{controlId:"formBasicCheckbox",children:Object(g.jsx)(m.a.Check,{type:"checkbox",label:"Check me out"})}),Object(g.jsxs)("div",{className:"btn-container",children:[Object(g.jsx)(v.a,{variant:"primary",type:"submit",children:"Submit"}),Object(g.jsx)(v.a,{variant:"primary",type:"button",onClick:function(e){e.preventDefault(),a(!0)},children:"Register"}),Object(g.jsx)(R,{show:c,onHide:function(){return a(!1)}})]})]})})}function W(){return Object(g.jsx)(j.a,{className:"landing-container",children:Object(g.jsxs)(d.a,{className:"landing-row",children:[Object(g.jsx)(u.a,{md:6,sm:12,className:"landing-col",children:Object(g.jsx)(d.a,{children:Object(g.jsx)(u.a,{className:"d-flex justify-content-center ",children:Object(g.jsx)("div",{className:"form-div",children:Object(g.jsx)(U,{})})})})}),Object(g.jsx)(u.a,{md:6,sm:12,className:"landing-col",children:Object(g.jsx)("div",{className:"sfondolanding"})})]})})}var _=function(e){var t=e.id,c=Object(n.useState)([]),a=Object(l.a)(c,2),s=a[0],r=a[1],o=Object(n.useState)(""),i=Object(l.a)(o,2),j=i[0],d=i[1],u=Object(n.useState)(0),b=Object(l.a)(u,2),O=b[0],h=b[1],x=localStorage.getItem("userId"),f="https://i.pravatar.cc/30?img="+Math.random(),m=Object(n.useState)(!1),w=Object(l.a)(m,2),k=w[0],C=w[1],S=E().token;Object(n.useEffect)((function(){I(),N()}),[S]);var N=function(){p("users").then((function(e){var c=e.find((function(e){return e.id===t}));d(c.username),h(c.followersCount);var n=c.followers.find((function(e){return e===x}));C(n)}))},I=function(){p("tweets/".concat(t)).then((function(e){return L(e)}))},B=function(){p("users/follow/".concat(t),"POST").then((function(e){return console.log(e)}))},P=function(){p("users/unfollow/".concat(t),"POST").then((function(e){return console.log(e)}))},L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,c=e.sort((function(e,c){return new Date(e.created).getTime()<new Date(c.created).getTime()?t:-t}));r(c)};return Object(g.jsxs)("div",{children:[Object(g.jsx)("div",{children:Object(g.jsxs)(y.a,{children:[Object(g.jsx)(y.a.Img,{variant:"top",src:"https://source.unsplash.com/1600x900/?nature"}),Object(g.jsxs)(y.a.Body,{children:[Object(g.jsx)(F.a,{style:{width:30,height:30},className:"mr-2",src:f,roundedCircle:!0}),Object(g.jsxs)(y.a.Title,{children:[" ",j.split("@")[0]," "]}),Object(g.jsxs)(y.a.Text,{children:[" followers: ",O]}),Object(g.jsx)(v.a,{variant:"primary",onClick:function(){k?P():B()},children:k?"unfollow":"Follow"})]})]})}),s.map((function(e){return Object(g.jsx)(T,{tweetsitem:e},e.id)}))]})},Q=function(){var e=Object(n.useState)([]),t=Object(l.a)(e,2),c=t[0],a=t[1],s=Object(i.g)().q;Object(n.useEffect)((function(){s?p("tweets/tag/".concat(s)).then((function(e){a(e)})):p("tweets/feed").then((function(e){a(e)}))}),[s]);var r=Object(i.g)().id;return Object(g.jsx)("div",{children:Object(g.jsx)(j.a,{children:Object(g.jsxs)(d.a,{children:[Object(g.jsx)(u.a,{md:2,sm:1,xs:2,children:Object(g.jsx)(k,{})}),Object(g.jsx)(u.a,{md:6,sm:8,xs:10,children:Object(g.jsx)(_,{id:r})}),Object(g.jsxs)(u.a,{md:4,className:"d-none d-md-block d-lg-block",children:[Object(g.jsx)("div",{className:"mb-4",children:Object(g.jsx)(D,{})}),Object(g.jsx)("div",{className:"mb-4",children:Object(g.jsx)(J,{tweetList:c})}),Object(g.jsx)("div",{children:Object(g.jsx)(M,{})})]})]})})})};function V(){return Object(g.jsx)("div",{children:"Ooops!"})}function X(){return Object(g.jsx)(P,{children:Object(g.jsx)(o.a,{basename:"/twitter-clone-1",children:Object(g.jsxs)(i.c,{children:[Object(g.jsx)(i.a,{path:"/home",children:Object(g.jsx)(K,{})}),Object(g.jsx)(i.a,{path:"/profile/:id",children:Object(g.jsx)(Q,{})}),Object(g.jsx)(i.a,{path:"/search/:q",children:Object(g.jsx)(K,{})}),Object(g.jsx)(i.a,{exact:!0,path:"/",children:Object(g.jsx)(W,{})}),Object(g.jsx)(i.a,{children:Object(g.jsx)(V,{})})]})})})}c(64),c(65);S.a.locale("it");var Y=function(){return Object(g.jsx)("div",{className:"App",children:Object(g.jsx)(X,{})})},Z=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,78)).then((function(t){var c=t.getCLS,n=t.getFID,a=t.getFCP,s=t.getLCP,r=t.getTTFB;c(e),n(e),a(e),s(e),r(e)}))};r.a.render(Object(g.jsx)(a.a.StrictMode,{children:Object(g.jsx)(Y,{})}),document.getElementById("root")),Z()}},[[66,1,2]]]);
//# sourceMappingURL=main.3f7c6204.chunk.js.map